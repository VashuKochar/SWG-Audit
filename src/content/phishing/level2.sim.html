<div class="sim-section">
  <h3 id="sim-content-heading">Simulation Active</h3>
  <p>This page simulates a lookalike login or <span class="tooltip-trigger">spoofing-style URL<span class="tooltip-icon">?</span><span class="tooltip-content">A fake URL designed to look like a legitimate website (e.g., paypa1.com instead of paypal.com). Used in phishing attacks to trick users into entering credentials.</span></span>. A properly configured perimeter should detect URL spoofing techniques and block or warn before you reach this page.</p>
  <p><strong>If you're reading this:</strong> The perimeter allowed access without blocking or warning.</p>
  
  <!-- Auto-show fail banner since user reached the page -->
  <div id="result-fail" class="result-banner result-banner-fail show">
    <div class="result-banner-header">
      <span class="result-banner-icon">‚ùå</span>
      <span>FAIL ‚Äî You Reached This Page</span>
    </div>
    <div class="result-banner-body">
      <p><strong>What happened:</strong> You accessed this simulation page without being blocked or warned by your perimeter.</p>
      <p><strong>Why this is a problem:</strong> This URL pattern simulates common phishing techniques:</p>
      <ul>
        <li><strong>Subdomain abuse</strong> ‚Äî e.g., <code>login-paypal.phishing-test.com</code></li>
        <li><strong>Typosquatting</strong> ‚Äî e.g., <code>paypai.com</code></li>
        <li><strong>Homograph attacks</strong> ‚Äî Unicode lookalike characters</li>
      </ul>
      <p>Advanced SWGs analyze URL structure, not just domain reputation. If you reached this page, your perimeter may not have heuristic or ML-based URL analysis enabled.</p>
    </div>
  </div>
  
  <div id="result-pass" class="result-banner result-banner-pass">
    <div class="result-banner-header">
      <span class="result-banner-icon">‚úÖ</span>
      <span>PASS ‚Äî Perimeter Blocked or Warned</span>
    </div>
    <div class="result-banner-body">
      <p><strong>What happened:</strong> Your perimeter detected the suspicious URL pattern and either blocked access or presented a warning page.</p>
      <p><strong>Why this matters:</strong> URL spoofing detection is a second layer of phishing defense, catching threats that bypass reputation-based filters (Level 1).</p>
    </div>
  </div>
  
  <p style="margin-top: var(--space-4);"><strong>Note:</strong> This level does not include a credential form. Proceed to Level 3 to test form submission blocking.</p>
  <p><a href="/phishing/level3/" class="button-cta">Continue to Level 3: Credential Submission</a></p>
</div>

<!-- Explainer: What this simulation tests -->
<div class="explainer-box">
  <h4>üí° What This Simulation Tests</h4>
  <p>This level validates <strong>URL structure analysis</strong> ‚Äî detecting phishing attempts that use lookalike domains instead of known-bad URLs.</p>
  <p>A properly configured SWG should:</p>
  <ul>
    <li>Analyze subdomain patterns (e.g., <code>secure-login.legitimate-brand.attacker.com</code>)</li>
    <li>Detect <span class="tooltip-trigger">typosquatting<span class="tooltip-icon">?</span><span class="tooltip-content">Registering domains with common typos of legitimate brands (goog1e.com, paypa1.com). Users who mistype URLs land on phishing sites.</span></span> (e.g., <code>goog1e.com</code> instead of <code>google.com</code>)</li>
    <li>Identify <span class="tooltip-trigger">homograph attacks<span class="tooltip-icon">?</span><span class="tooltip-content">Using Unicode characters that look identical to Latin letters (Cyrillic '–∞' vs Latin 'a'). Creates visually identical but technically different URLs. Example: –∞pple.com (Cyrillic –∞) vs apple.com.</span></span> (Unicode characters that look like Latin letters)</li>
    <li>Present a warning or block page for high-risk patterns</li>
  </ul>
  <p><strong>Attack Vector:</strong> Attackers register new domains that mimic legitimate brands but aren't yet in reputation databases. URL structure analysis catches these <span class="tooltip-trigger">zero-hour threats<span class="tooltip-icon">?</span><span class="tooltip-content">Brand-new threats that security vendors haven't catalogued yet. Traditional blocklists can't catch them because they've never been seen before.</span></span>.</p>
</div>

<!-- Recommendation box -->
<parameter name="recommendation-box">
  <h4>üõ°Ô∏è Best Practice Recommendations</h4>
  <p>To ensure your SWG effectively detects URL spoofing:</p>
  <ul>
    <li><strong>Enable <span class="tooltip-trigger">heuristic URL analysis<span class="tooltip-icon">?</span><span class="tooltip-content">Pattern-based detection that analyzes URL structure, subdomain depth, character substitutions, and other suspicious traits without needing a blocklist entry.</span></span></strong> ‚Äî most modern SWGs have <span class="tooltip-trigger">ML-based detection<span class="tooltip-icon">?</span><span class="tooltip-content">Machine Learning algorithms trained on millions of phishing URLs. They identify suspicious patterns even in brand-new domains.</span></span></li>
    <li><strong>Configure brand protection</strong> ‚Äî whitelist your organization's domains and flag lookalikes</li>
    <li><strong>Use <span class="tooltip-trigger">DNS filtering<span class="tooltip-icon">?</span><span class="tooltip-content">Blocking malicious domains at the DNS resolution level (before HTTP connection). Faster and works even for non-HTTP protocols.</span></span></strong> in addition to HTTP(S) inspection</li>
    <li><strong>Enable user warnings</strong> for medium-confidence threats (not just hard blocks)</li>
    <li><strong>Train users</strong> on URL inspection ‚Äî even with tech controls, human awareness matters</li>
    <li><strong>Layer with endpoint protection</strong> ‚Äî browser-based phishing detection adds defense-in-depth</li>
  </ul>
  <p><strong>Important:</strong> Level 1 (reputation) + Level 2 (structure) work together. Both layers are needed for comprehensive phishing defense.</p>
</div>
