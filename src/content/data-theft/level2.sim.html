<div class="sim-section">
  <h3 id="sim-content-heading">DLP Signature Test</h3>
  <p>Upload a file containing test credit card numbers or fake SSN. A properly configured SWG with DLP should detect and block these patterns.</p>
  
  <form id="upload-form">
    <div id="file-choice" class="data-theft-choice">
      <p><strong>Choose file</strong></p>
      <p class="data-theft-samples">
        <span class="data-theft-sample-label">Use sample:</span>
        <button type="button" id="sample-dlp" aria-label="Use sample DLP test file">DLP test (card + SSN)</button>
      </p>
      <p class="data-theft-upload-label">Or upload your own file (max 1 KB)</p>
      <div id="upload-area" class="data-theft-upload-area" role="button" tabindex="0" aria-label="Drag and drop or click to select a file">
        <span class="data-theft-upload-text">Drag and drop or click to select a file</span>
        <input type="file" id="file" name="file" accept="*" class="data-theft-file-input">
      </div>
    </div>
    <div id="current-file-block" class="data-theft-current" hidden>
      <p><strong>Current file:</strong> <span id="current-file-name" aria-live="polite"></span><span id="current-file-size" class="data-theft-filesize" aria-live="polite"></span></p>
      <p>
        <label for="file-name">File name (optional)</label><br>
        <input type="text" id="file-name" name="file-name" aria-label="File name for upload">
      </p>
      <p>
        <button type="button" id="change-file" aria-label="Choose a different file or sample">Change file</button>
        <button type="submit">Upload file</button>
      </p>
    </div>
  </form>
  
  <div id="upload-result-block" class="data-theft-result" hidden>
    <h4 id="upload-result-heading"></h4>
    <p id="upload-result-message"></p>
    <p id="upload-result-url-wrap" class="data-theft-result-url" hidden></p>
    <p id="upload-result-delete-msg" class="data-theft-delete-msg" hidden>File will be deleted from the server in <span id="upload-timer" aria-live="polite">10:00</span></p>
    <p><button type="button" id="reset-test-btn" class="button-secondary">Reset test</button></p>
  </div>
  
  <!-- Enhanced result banners -->
  <div id="result-pass" class="result-banner result-banner-pass">
    <div class="result-banner-header">
      <span class="result-banner-icon">‚úÖ</span>
      <span>PASS ‚Äî Sensitive Data Blocked</span>
    </div>
    <div class="result-banner-body">
      <p><strong>What happened:</strong> Your SWG detected sensitive data patterns (credit card, SSN) and blocked the upload.</p>
      <p><strong>Why this matters:</strong> This demonstrates content-aware DLP:</p>
      <ul>
        <li>Pattern matching (credit card numbers, SSN formats)</li>
        <li>Content inspection (not just file type or size)</li>
        <li>Prevents accidental or malicious data leaks</li>
        <li>Compliance enforcement (PCI-DSS, HIPAA, GDPR)</li>
      </ul>
      <p>Even if a user doesn't realize a file contains sensitive data, DLP catches it.</p>
    </div>
  </div>
  
  <div id="result-fail" class="result-banner result-banner-fail">
    <div class="result-banner-header">
      <span class="result-banner-icon">‚ùå</span>
      <span>FAIL ‚Äî Sensitive Data Uploaded</span>
    </div>
    <div class="result-banner-body">
      <p><strong>What happened:</strong> The file containing sensitive data (credit card/SSN) was uploaded successfully.</p>
      <p><strong>Why this is a critical problem:</strong> Your DLP did not detect the sensitive patterns. This means:</p>
      <ul>
        <li><strong>PCI-DSS violation:</strong> Credit card data left the network</li>
        <li><strong>HIPAA/privacy risk:</strong> SSN or PII could be stolen</li>
        <li><strong>Regulatory fines:</strong> Compliance failures can cost millions</li>
        <li><strong>Reputational damage:</strong> Data breaches destroy trust</li>
      </ul>
      <p><strong>What to check:</strong></p>
      <ul>
        <li>Is DLP pattern matching enabled? (credit card, SSN, PII)</li>
        <li>Is content inspection active for file uploads?</li>
        <li>Are DLP signatures up to date?</li>
        <li>Is SSL/TLS inspection enabled? (can't inspect HTTPS without decryption)</li>
      </ul>
    </div>
  </div>
</div>

<!-- Explainer: What this simulation tests -->
<div class="explainer-box">
  <h4>üí° What This Simulation Tests</h4>
  <p>This level validates <strong>DLP pattern matching</strong> ‚Äî detecting sensitive data by content, not just file type.</p>
  <p><strong>Test data patterns used:</strong></p>
  <ul>
    <li><strong>Credit card:</strong> Valid Luhn algorithm test numbers (4111-1111-1111-1111)</li>
    <li><strong>SSN:</strong> Fake SSN in XXX-XX-XXXX format (123-45-6789)</li>
  </ul>
  <p>A properly configured SWG with DLP should:</p>
  <ul>
    <li>Scan file content for regex patterns (credit card, SSN, passport numbers)</li>
    <li>Validate matches (e.g., Luhn algorithm for cards)</li>
    <li>Block uploads containing matches</li>
    <li>Alert security team with details</li>
  </ul>
  <p><strong>Real-world scenarios:</strong></p>
  <ul>
    <li>Employee accidentally uploads customer spreadsheet to personal Dropbox</li>
    <li>Compromised account exfiltrates payment records</li>
    <li>Contractor copies patient database to USB (if SWG inspects local uploads)</li>
  </ul>
  <p><strong>Attack Vector:</strong> Data theft often happens through legitimate upload mechanisms (cloud storage, email) rather than malware. DLP is the primary defense.</p>
</div>

<!-- Recommendation box -->
<div class="recommendation-box">
  <h4>üõ°Ô∏è Best Practice Recommendations</h4>
  <p>To ensure your DLP effectively detects sensitive data:</p>
  <ul>
    <li><strong>Enable comprehensive patterns:</strong> Credit cards, SSN, passport, driver's license, IBAN, API keys</li>
    <li><strong>Use validation algorithms:</strong> Luhn check for cards, SSN format validation</li>
    <li><strong>Custom dictionaries:</strong> Add company-specific patterns (employee IDs, product codes)</li>
    <li><strong>Contextual scanning:</strong> Look for patterns near keywords ("credit card", "SSN")</li>
    <li><strong>False positive tuning:</strong> Adjust sensitivity to avoid blocking legitimate data</li>
    <li><strong>Multi-layer detection:</strong> Combine pattern matching with document fingerprinting</li>
    <li><strong>Encrypted file handling:</strong> Block password-protected uploads or require decryption</li>
    <li><strong>Image OCR:</strong> Scan screenshots for text containing sensitive data</li>
  </ul>
  <p><strong>Compliance requirements:</strong></p>
  <ul>
    <li><strong>PCI-DSS:</strong> Requirement 3 ‚Äî protect stored cardholder data, block exfiltration</li>
    <li><strong>HIPAA:</strong> PHI protection ‚Äî prevent unauthorized disclosure</li>
    <li><strong>GDPR:</strong> Article 32 ‚Äî appropriate technical measures to protect personal data</li>
  </ul>
  <p><strong>Note:</strong> Level 1 tested generic upload blocking. Level 3 tests DNS-based exfiltration (DLP bypass technique).</p>
</div>
