<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Theft – DNS exfil – SWG Audit</title>
  <meta name="description" content="Data theft simulation: DNS exfil. Small payload sent to server. Request succeeds = perimeter did not block. Request blocked = review SWG or DNS logs.">
  <meta name="keywords" content="SWG Audit, data theft test, DNS exfil, exfiltration, perimeter security">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
  <link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png">
</head>
<body>
  {{> header }}


  <main>
    <div class="page-hero">
      <div class="page-hero-inner">
        <h2 id="data-theft-l3-heading" class="landing-hero-headline">DNS exfil simulation</h2>
      </div>
    </div>
    <div class="section-strip">
      <section class="section" aria-labelledby="data-theft-l3-heading">
    <p>Simulated exfil: a small payload is sent to the server. Request succeeds = perimeter did not block. Request blocked = review SWG or DNS security logs to confirm the block.</p>
    <p><button type="button" id="exfil-btn">Send simulated exfil payload</button></p>
    <p id="exfil-result" hidden></p>
    <p><a href="/data-theft/level1/">File upload</a> · <a href="/data-theft/level2/">DLP signatures</a></p>
      </section>
    </div>
  </main>

  {{> footer }}


  <script>
    (function () {
      var exfilBtn = document.getElementById('exfil-btn');
      var exfilResult = document.getElementById('exfil-result');
      exfilBtn.addEventListener('click', function () {
        var payload = btoa('test-exfil-' + Date.now());
        exfilResult.hidden = true;
        fetch('/data-theft/exfil?data=' + encodeURIComponent(payload))
          .then(function (r) { return r.json(); })
          .then(function (data) {
            exfilResult.textContent = 'Perimeter Security Failed – ' + (data.message || 'Exfil request reached server.');
            exfilResult.className = 'error';
            exfilResult.hidden = false;
          })
          .catch(function () {
            exfilResult.textContent = 'Request blocked or failed. Perimeter may have passed.';
            exfilResult.className = 'success';
            exfilResult.hidden = false;
          });
      });
    })();
  </script>
</body>
</html>
